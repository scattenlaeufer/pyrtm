<MainBox>:
	orientation: "vertical"
	TabbedPanel:
		do_default_tab: False
		TabbedPanelItem:
			text: "Battle"
			BoxLayout:
				orientation: "horizontal"
				ScrollView:
					BoxLayout:
						id: weapon_box
						orientation: "vertical"
						height: 0
						size_hint_y: None
						minimun_height: self.setter("height")
				BoxLayout:
					orientation: "vertical"
					BoxLayout:
						orientation: "vertical"
						size_hint_y: None
						height: wounds_max.font_size * 4 + button_heal.font_size * 2.5
						Label:
							text: "Wounds"
							height: self.font_size * 2
							size_hint_y: None
						BoxLayout:
							size_hint_y: None
							height: wounds_max.font_size * 2
							orientation: "horizontal"
							Label:
								text: "max:"
							Label:
								id: wounds_max
								text: "10"
							Label:
								text: "current:"
							Label:
								id: wounds_current
								text: "10"
							Label:
								text: "critical:"
							Label:
								id: wounds_critical
								text: "0"
						BoxLayout:
							orientation: "horizontal"
							size_hint_y: None
							height: button_heal.font_size * 2.5
							Button:
								id: button_take_damage
								text: "Take Damage"
							Button:
								id: button_heal
								text: "Heal Damage"
							Button:
								id: button_critical_damaga
								text: "Manage Crticial Damage"
					BoxLayout:
						orientation: "vertical"
						size_hint_y: None
						height: fatigue_current.font_size * 4 + fatigue_add.font_size * 2.5
						Label:
							text: "Fatigue"
						BoxLayout:
							orientation: "horizontal"
							Label:
								text: "max:"
							Label:
								id: fatigue_max
								text: "3"
							Label:
								text: "current:"
							Label:
								id: fatigue_current
								text: "0"
						BoxLayout:
							orientation: "horizontal"
							size_hint_y: None
							height: fatigue_add.font_size * 2.5
							Button:
								id: fatigue_add
								text: "Add Fatigue"
							Button:
								id: fatigue_remove
								text: "Remove Fatigue"
					BoxLayout:
						orientation: "vertical"
						size_hint_y: None
						height: fate_max.font_size * 4 + button_fate_spend.font_size * 2.5
						Label:
							text: "Fate Points"
						BoxLayout:
							orientation: "horizontal"
							Label:
								text: "max:"
							Label:
								id: fate_max
							Label:
								text: "current:"
							Label:
								id: fate_current
						BoxLayout:
							orientation: "horizontal"
							size_hint_y: None
							height: button_fate_spend.font_size * 2.5
							Button:
								id: button_fate_spend
								text: "spend"
							Button:
								id: button_fate_refill
								text: "refill"
							Button:
								id: button_fate_change
								text: "change number"
					Label:
						text: "blubb"
		TabbedPanelItem:
			text: 'General'
			BoxLayout:
				orientation: 'horizontal'
				BoxLayout:
					orientation: 'vertical'
					BoxLayout:
						id: characteristics
						orientaiton: "horizontal"
						size_hint_y: .1
						CharacteristicButton:
							id: ws
							_text: "Weapon Skill\n(WS)\n[size={}]{}[/size]\nadvanced: {}"
							on_press: root.characteristics_test(self)
						CharacteristicButton:
							id: bs
							_text: "Ballistic Skill\n(BS)\n[size={}]{}[/size]\nadvanced: {}"
							on_press: root.characteristics_test(self)
						CharacteristicButton:
							id: s
							_text: "Strength\n(S)\n[size={}]{}[/size]\nadvanced: {}"
							on_press: root.characteristics_test(self)
						CharacteristicButton:
							id: t
							_text: "Toughness\n(T)\n[size={}]{}[/size]\nadvanced: {}"
							on_press: root.characteristics_test(self)
						CharacteristicButton:
							id: ag
							_text: "Agility\n(Ag)\n[size={}]{}[/size]\nadvanced: {}"
							on_press: root.characteristics_test(self)
						CharacteristicButton:
							id: int
							_text: "Intelligence\n(Int)\n[size={}]{}[/size]\nadvanced: {}"
							on_press: root.characteristics_test(self)
						CharacteristicButton:
							id: per
							_text: "Perception\n(Per)\n[size={}]{}[/size]\nadvanced: {}"
							on_press: root.characteristics_test(self)
						CharacteristicButton:
							id: wp
							_text: "Will Power\n(WP)\n[size={}]{}[/size]\nadvanced: {}"
							on_press: root.characteristics_test(self)
						CharacteristicButton:
							id: fel
							_text: "Fellowship\n(Fel)\n[size={}]{}[/size]\nadvanced: {}"
							on_press: root.characteristics_test(self)
					ScrollView:
						BoxLayout:
							id: skill_box
							orientation: "vertical"
							size_hint_y: None
							minimun_height: self.setter("height")
				BoxLayout:
					orientation: "vertical"
					BoxLayout:
						orientation: 'vertical'
						Label:
							text: 'Talents'
							size_hint_y: None
							height: self.font_size * 2
						ScrollView:
							BoxLayout:
								id: talents_box
								orientation: "vertical"
								height: 0
								size_hint_y: None
								minimun_height: self.setter("height")
					BoxLayout:
						orientation: 'vertical'
						Label:
							text: 'Implants'
							size_hint_y: None
							height: self.font_size * 2
						ScrollView:
							BoxLayout:
								id: implants_box
								orientation: "vertical"
								height: 0
								size_hint_y: None
								minimun_height: self.setter("height")
		TabbedPanelItem:
			id: all_talents
			text: 'all talents'
		TabbedPanelItem:
			id: settings
			text: "Settings"
			BoxLayout:
				orientation: "vertical"
				ConfigButton:
					text: "Rogue Trader always"
					group: "dos_algorithm"
					id: dos_rt
					allow_no_selection: False
					on_press: self.config_action()
				ConfigButton:
					text: "Dark Heresy 2 in Battle | Rogue Trader else"
					group: "dos_algorithm"
					id: dos_mixed
					allow_no_selection: False
					on_press: self.config_action()
				ConfigButton:
					text: "Dark Heresy 2 always"
					group: "dos_algorithm"
					id: dos_dh2
					allow_no_selection: False
					on_press: self.config_action()
				Button:
					id: button_reset
					text: "Reset character"


<CharacteristicButton>:
	markup: True
	font_size: pt(5)
	valign: "center"
	halign: "center"

<CharacteristicLayout>:
	orientation: "vertical"
	CharacteristicNameLabel:
		id: name
	characteristicValueLabel
		id:value

<TalentButton>:
	size_hint_y: None
	height: self.font_size * 2
	text_size: self.width - self.font_size * 2, self.height
	valign: "center"

<WeaponBoxButton@Button>:
	text_size: self.width, self.height
	valign: "center"
	halign: "center"

<SkillBox>:
	canvas.before:
		Color:
			rgba: (.15, .15, .15, 1) if self.bg else (.1, .1, .1, 1)
		Rectangle:
			pos: self.pos
			size: self.size
	orientation: "horizontal"
	size_hint_y: None
	height: button_info.font_size * 2
	Button:
		id: button_info
		background_color: (1, 1, 1, 1) if root.bg else (.8, .8, .8, 1)
		text: "Info"
		on_press: root.skill_info()
		text_size: self.width - self.font_size * 2, self.height
		valign: "center"
	Label: 
		id: characteristic
		size_hint_x: .2
	Label:
		id: status
		size_hint_x: .2
	Button:
		id: button_test
		text: "Test"
		background_color: (1, 1, 1, 1) if root.bg else (.8, .8, .8, 1)
		size_hint_x: .4
		on_press: root.do_test()

<ImplantBox>:
	orientation: "horizontal"
	size_hint_y: None
	height: button_name.font_size * 2
	Switch
		id: switch_on
		size_hint_x: None
		width: button_name.font_size * 6.5
	Button:
		id: button_name
		text: "Implant X"
		text_size: self.width - self.font_size, self.height
		valign: "center"
		on_press: root.button_info_press()
	BoxLayout:
		size_hint_x: .6
		Label:
			text: "Quality:"
		Label:
			id: label_quality

<WeaponBox>:
	orientation: "vertical"
	size_hint_y: None
	#height: name.font_size * 15
	Button:
		id: name
		size_hint_y: None
		height: self.font_size * 2.5
	BoxLayout:
		orientation: "horizontal"
		size_hint_y: None
		height: name.font_size * 2
		# Label:
		# 	id: label_class
		Label:
			id: label_range
		Label:
			id: label_rof
		Label:
			id: label_damage
		Label:
			id: label_pen
	BoxLayout:
		orientaiton: "horizontal"
		size_hint_y: None
		height: name.font_size * 2
		Label:
			id: label_class
		Label:
			id: label_clip
		Label:
			id: label_reload
		Label:
			id: label_weight
		# Label:
		# 	id: label_availability
		# Label:
		# 	id: blubb
	GridLayout:
		id: special_box
		cols: 5
		col_force_default: True
		col_default_width: self.width // 5
		row_force_default: True
		row_default_height: name.font_size * 2.5
		Label:
			text: "Special Qualities:"
			text_size: self.width, self.height
			valign: "center"
			halign: "center"
	BoxLayout:
		orientation: "horizontal"
		size_hint_y: None
		height: name.font_size * 2.5
		Button:
			id: button_attack
			text: "Attack"
			on_press: root.attack_test()
		Button:
			id: button_dodge
			text: "Dodge"
			on_press: root.dodge_test()
		Button:
			id: button_parry
			text: "Parry"
			on_press: root.parry_test()
		Button:
			id: button_take_damage
			text: "Take Damage"

<ModifierBox>:
	orientation: "horizontal"
	size_hint_y: None
	height: label_name.font_size * 2
	CheckBox:
		id: checkbox_on
		size_hint_x: .2
	Label:
		id: label_name
		text_size: self.width - self.font_size, self.height
		valign: "center"

<StartLayout>:
	cols: 2
	spacing: 5

<DropdownButton>:
	size_hint_y: None
	height: self.font_size * 2

<HitLocationButton>:
	size_hint_y: None
	height: self.font_size * 2

<InfoPopup>:
	size_hint: .5, .7
	BoxLayout:
		orientation: "vertical"
		RstDocument:
			id: label_info
		Button:
			size_hint: 1, .15
			text: 'Ok'
			on_press: root.dismiss()

<TestPopup>:
	size_hint: .5, .7
	BoxLayout:
		orientation: "vertical"
		GridLayout:
			cols: 2
			BoxLayout:
				orientation: "horizontal"
				size_hint_y: None
				height: button_difficulty.font_size * 2
				Label:
					text: "Difficulty"
				Button:
					text: "Chellenging (+0)"
					id: button_difficulty
		BoxLayout:
			orientation: "horizontal"
			size_hint_y: None
			height: misc_label.font_size * 2
			Label:
				text: "Misc Modifier:"
				id: misc_label
			TextInput:
				id: textinput_misc
				text: ""
				multiline: False
				input_filter: "int"
				valign: "center"
				on_text: root.set_misc_modifier(self, self.text)
		ScrollView:
			BoxLayout:
				id: modifier_box
				orientation: "vertical"
				size_hint_y: None
				minimun_height: self.setter("height")
		Label:
			size_hint_y: None
			height: button_roll_test.font_size
		BoxLayout:
			orientation: "horizontal"
			size_hint_y: None
			height: button_roll_test.font_size * 3
			BoxLayout:
				orientation: "horizontal"
				Label:
					text: "Current value:"
				Label:
					id: label_current_value
					size_hint_x: .5
					text: "0"
			Button:
				id: button_roll_test
				text: "Roll!"
				on_press: root.roll_test()
			Label:
				canvas.before:
					Color:
						rgba: (0, .5, 0, 1) if root.success == "yes" else (.5, 0, 0, 1) if root.success == "no" else (.155, .155, .155, 1)
					Rectangle:
						pos: self.pos
						size: self.size
				id: label_result
			Label:
				canvas.before:
					Color:
						rgba: (0, .5, 0, 1) if root.success == "yes" else (.5, 0, 0, 1) if root.success == "no" else (.155, .155, .155, 1)
					Rectangle:
						pos: self.pos
						size: self.size
				id: label_degrees
		Label:
			size_hint_y: None
			height: button_roll_test.font_size
		BoxLayout:
			id: button_box
			orientation: "horizontal"
			size_hint_y: None
			height: button_cancel.font_size * 3
			Button:
				id: button_cancel
				text: "Cancel"
				on_press: root.dismiss()
			# Button:
			# 	id: button_info
			# 	text: "Info"
			# 	on_press: root.dismiss()
			Button:
				id: button_ok
				text: "Ok"
				on_press: root.dismiss()
			Button:
				id: button_damage
				text: "Damage"
				disabled: True
				opacity: 0

<DamagePopup>:
	size_hint: .4, .4
	title: "Damage"
	BoxLayout:
		orientation: "vertical"
		BoxLayout:
			orientation: "horizontal"
			Label:
				text: "Hit Location"
			Label:
				id: label_hit_location
		BoxLayout:
			orientation: "horizontal"
			Label:
				text: "Damage"
			Label:
				id: label_damage
		BoxLayout:
			orientation: "horizontal"
			Label:
				text: "Righteous Fury"
			Label:
				id: label_rf
				text: "No"
		Button:
			text: "Ok"
			on_press: root.dismiss()

<TakeDamagePopup>
	size_hint: .4, .4
	title: "Take Damage"
	BoxLayout:
		orientation: "vertical"
		BoxLayout:
			orientation: "horizontal"
			size_hint_y: None
			height: input_damage.font_size * 2
			Label:
				text: "Raw Damage:"
			TextInput:
				id: input_damage
				input_filter: "int"
				multiline: False
				valign: "center"
		BoxLayout:
			orientation: "horizontal"
			size_hint_y: None
			height: input_pen.font_size * 2
			Label:
				text: "Penetration:"
			TextInput:
				id: input_pen
				input_filter: "int"
				multiline: False
				valign: "center"
		BoxLayout:
			orientation: "horizontal"
			size_hint_y: None
			height: input_damage.font_size * 2
			Label:
				text: "Hit Location:"
			Button:
				id: button_hit_location
				text: "Body"
		BoxLayout:
			orientation: "horizontal"
			size_hint_y: None
			height: input_damage.font_size * 4
			Label:
				text: "Damage Reduction:"
			BoxLayout:
				orientation: "vertical"
				BoxLayout:
					orientation: "horizontal"
					CheckBox:
						id: damage_toughness
						active: True
						size_hint_x: None
						width: input_damage.font_size * 2
					Label:
						text: "Toughness"
				BoxLayout:
					orientation: "horizontal"
					CheckBox:
						id: damage_armour
						active: True
						size_hint_x: None
						width: input_damage.font_size * 2
					Label:
						text: "Armour"
		Label:
			text: ""
		BoxLayout:
			orientation: "horizontal"
			size_hint_y: None
			height: button_ok.font_size * 3
			Button:
				id: button_ok
				text: "Ok"
				on_press: root.ok()
			Button:
				text: "Cancel"
				on_press: root.dismiss()

<HealDamagePopup>
	size_hint: .4, .4
	title: "Heal Damage"
	BoxLayout:
		orientation: "vertical"
		BoxLayout:
			orientation: "horizontal"
			size_hint_y: None
			height: input_value.font_size * 2
			Label:
				text: "Damage healed:"
			TextInput:
				id: input_value
				input_filter: "int"
				multiline: False
				valign: "center"
		BoxLayout:
			orientation: "horizontal"
			size_hint_y: None
			height: button_ok.font_size * 3
			Button:
				id: button_ok
				text: "Ok"
				on_press: root.ok()
			Button:
				text: "Cancel"
				on_press: root.dismiss()
